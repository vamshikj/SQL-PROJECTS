CREATE DATABASE CUSTOMER_ORDERS_PRODUCTS

CREATE TABLE CUSTOMERS
(
CUSTOMER_ID INT PRIMARY KEY,
NAME VARCHAR (50),
EMAIL VARCHAR(50),
)

SELECT * FROM CUSTOMERS 

INSERT INTO CUSTOMERS (CUSTOMER_ID,NAME,EMAIL)
VALUES  (1,'John Doe','johndoe@example.com')

INSERT INTO CUSTOMERS (CUSTOMER_ID,NAME,EMAIL)
VALUES  (2,'Jane Smith','janesmith@example.com')

INSERT INTO CUSTOMERS (CUSTOMER_ID,NAME,EMAIL)
VALUES  (3,'Robert Johnson','robertjohnson@example.com')

INSERT INTO CUSTOMERS (CUSTOMER_ID,NAME,EMAIL)
VALUES  (4,'Emily Brown','emilybrown@example.com')

INSERT INTO CUSTOMERS (CUSTOMER_ID,NAME,EMAIL)
VALUES  (5,'Michael Davis','michaeldavis@example.com')

INSERT INTO CUSTOMERS (CUSTOMER_ID,NAME,EMAIL)
VALUES  (6,'Sarah Wilson','sarahwilson@example.com')

INSERT INTO CUSTOMERS (CUSTOMER_ID,NAME,EMAIL)
VALUES  (7,'David Thomson','davidthomson@example.com')

INSERT INTO CUSTOMERS (CUSTOMER_ID,NAME,EMAIL)
VALUES  (8,'Jessica Lee','jessicalee@example.com')

INSERT INTO CUSTOMERS (CUSTOMER_ID,NAME,EMAIL)
VALUES  (9,'William Turner','williamturner@example.com')

INSERT INTO CUSTOMERS (CUSTOMER_ID,NAME,EMAIL)
VALUES  (10,'Olivia Martinez','oliviamartinez@example.com')

SELECT * FROM CUSTOMERS 


.......................................................................
CREATE TABLE ORDERS
(
ORDER_ID INT PRIMARY KEY,
CUSTOMER_ID INT,
PRODUCT_NAME VARCHAR (50),
ORDER_DATE DATE,
QUANTITY INT,
)

SELECT * FROM ORDERS

INSERT INTO ORDERS (ORDER_ID,CUSTOMER_ID,PRODUCT_NAME,ORDER_DATE,QUANTITY)
VALUES(1, 1, 'Product A', '2023-07-01', 5)

INSERT INTO ORDERS (ORDER_ID,CUSTOMER_ID,PRODUCT_NAME,ORDER_DATE,QUANTITY)
VALUES(2, 2, 'Product B', '2023-07-02', 3)

INSERT INTO ORDERS (ORDER_ID,CUSTOMER_ID,PRODUCT_NAME,ORDER_DATE,QUANTITY)
VALUES (3, 3, 'Product C', '2023-07-03', 2)

INSERT INTO ORDERS (ORDER_ID,CUSTOMER_ID,PRODUCT_NAME,ORDER_DATE,QUANTITY)
VALUES (4, 4, 'Product A', '2023-07-04', 1)

INSERT INTO ORDERS (ORDER_ID,CUSTOMER_ID,PRODUCT_NAME,ORDER_DATE,QUANTITY)
VALUES (5, 5, 'Product B', '2023-07-05', 4)

INSERT INTO ORDERS (ORDER_ID,CUSTOMER_ID,PRODUCT_NAME,ORDER_DATE,QUANTITY)
VALUES (6, 6, 'Product C', '2023-07-06', 2)

INSERT INTO ORDERS (ORDER_ID,CUSTOMER_ID,PRODUCT_NAME,ORDER_DATE,QUANTITY)
VALUES (7, 7, 'Product A', '2023-07-07', 3)

INSERT INTO ORDERS (ORDER_ID,CUSTOMER_ID,PRODUCT_NAME,ORDER_DATE,QUANTITY)
VALUES (8, 8, 'Product B', '2023-07-08', 2)

INSERT INTO ORDERS (ORDER_ID,CUSTOMER_ID,PRODUCT_NAME,ORDER_DATE,QUANTITY) 
VALUES (9, 9, 'Product C', '2023-07-09', 5)

INSERT INTO ORDERS (ORDER_ID,CUSTOMER_ID,PRODUCT_NAME,ORDER_DATE,QUANTITY) 
VALUES (10, 10, 'Product A', '2023-07-10', 1)

SELECT * FROM ORDERS


.........................................................................
CREATE TABLE PRODUCTS
(
PRODUCT_ID INT PRIMARY KEY,
PRODUCT_NAME VARCHAR(50),
PRICE DECIMAL(10,2),
)

SELECT * FROM PRODUCTS

INSERT INTO PRODUCTS (PRODUCT_ID,PRODUCT_NAME,PRICE)
VALUES (1, 'Product A', 10.99)

INSERT INTO PRODUCTS (PRODUCT_ID,PRODUCT_NAME,PRICE)
VALUES (2, 'Product B', 8.99)

INSERT INTO PRODUCTS (PRODUCT_ID,PRODUCT_NAME,PRICE)
VALUES (3, 'Product C', 5.99)

INSERT INTO PRODUCTS (PRODUCT_ID,PRODUCT_NAME,PRICE)
VALUES (4, 'Product D', 12.99)

INSERT INTO PRODUCTS (PRODUCT_ID,PRODUCT_NAME,PRICE)
VALUES  (5, 'Product E', 7.99)

INSERT INTO PRODUCTS (PRODUCT_ID,PRODUCT_NAME,PRICE)
VALUES (6, 'Product F', 6.99)

INSERT INTO PRODUCTS (PRODUCT_ID,PRODUCT_NAME,PRICE)
VALUES (7, 'Product G', 9.99)

INSERT INTO PRODUCTS (PRODUCT_ID,PRODUCT_NAME,PRICE)
VALUES (8, 'Product H', 11.99)

INSERT INTO PRODUCTS (PRODUCT_ID,PRODUCT_NAME,PRICE)
VALUES (9, 'Product I', 14.99)

INSERT INTO PRODUCTS (PRODUCT_ID,PRODUCT_NAME,PRICE)
VALUES (10, 'Product J', 4.99)

SELECT * FROM PRODUCTS


......................................................................
SELECT * FROM CUSTOMERS
WHERE NAME LIKE 'J%'

......................................................................
SELECT SUM(QUANTITY) AS TOTAL_QUANTITY
FROM ORDERS

......................................................................
SELECT CUSTOMERS.NAME
FROM CUSTOMERS
JOIN ORDERS
ON ORDERS.CUSTOMER_ID = CUSTOMERS.CUSTOMER_ID

......................................................................
SELECT * FROM PRODUCTS
WHERE PRICE > 10.00

......................................................................
SELECT CUSTOMERS.NAME , ORDERS.ORDER_DATE
FROM CUSTOMERS 
JOIN ORDERS
ON ORDERS.CUSTOMER_ID = CUSTOMERS.CUSTOMER_ID
WHERE ORDER_DATE ='2023-07-05'

......................................................................
SELECT AVG(PRICE) AS AVERAGE_PRICE
FROM PRODUCTS

......................................................................
SELECT CUSTOMERS.NAME , ORDERS.QUANTITY
FROM CUSTOMERS 
JOIN ORDERS
ON ORDERS.CUSTOMER_ID = CUSTOMERS.CUSTOMER_ID

......................................................................
SELECT TOP(5)
QUANTITY
FROM ORDERS

......................................................................
SELECT AVG(PRICE) AS AVERAGE_PRICE
FROM PRODUCTS

......................................................................
SELECT ORDERS.ORDER_ID , ORDERS.PRODUCT_NAME , ORDERS.QUANTITY
FROM ORDERS
JOIN CUSTOMERS
ON ORDERS.CUSTOMER_ID = CUSTOMERS.CUSTOMER_ID
WHERE NAME LIKE 'M%'

......................................................................
SELECT SUM(PRICE)
FROM PRODUCTS 
JOIN 
ORDERS
ON 
ORDERS.PRODUCT_NAME = PRODUCTS.PRODUCT_NAME

.......................................................................
SELECT NAME , SUM(PRICE)
FROM CUSTOMERS
JOIN ORDERS
ON CUSTOMERS.CUSTOMER_ID = ORDERS.CUSTOMER_ID
JOIN PRODUCTS
ON PRODUCTS.PRODUCT_NAME = ORDERS.PRODUCT_NAME
GROUP BY PRICE,NAME

......................................................................
SELECT CUSTOMERS.NAME ,PRODUCTS.PRODUCT_NAME,ORDERS.QUANTITY
FROM CUSTOMERS
JOIN ORDERS
ON 
CUSTOMERS.CUSTOMER_ID = ORDERS.CUSTOMER_ID
JOIN PRODUCTS
ON
PRODUCTS.PRODUCT_NAME = ORDERS.PRODUCT_NAME
WHERE QUANTITY > 1

......................................................................
SELECT TOP(3) PRODUCT_NAME 
FROM ORDERS
WHERE QUANTITY = MAX(AVG(QUANTITY))

......................................................................
SELECT PRODUCT_NAME
FROM PRODUCTS
......................................................................
SELECT CUSTOMERS.NAME
FROM CUSTOMERS
JOIN 
(SETECT PRODUCTS.PRODUCT_NAME FROM PRDUCTS) AS P
ON CUSTOMERS.CUSTOMER_ID = ORDERS.CUSTOMER_ID
...........................................................................
SELECT NAME
FROM CUSTOMERS C,PRODUCTS P,ORDERS O
WHERE  C.CUSTOMER_ID = O.CUSTOMER_ID AND P.PRODUCT_NAME = O.PRODUCT_NAME


........................................................................
SELECT SUM(PRICE),ORDER_DATE
FROM PRODUCTS
JOIN
ORDERS
ON
ORDERS.PRODUCT_NAME = PRODUCTS.PRODUCT_NAME
GROUP BY ORDER_DATE                   


.....................................................................
SELECT PRODUCTS.PRODUCT_NAME,ORDERS.QUANTITY , CUSTOMERS.NAME
FROM ORDERS
JOIN 
CUSTOMERS
ON CUSTOMERS.CUSTOMER_ID = ORDERS.CUSTOMER_ID
JOIN PRODUCTS
ON PRODUCTS.PRODUCT_NAME = ORDERS.PRODUCT_NAME
 CUSTOMERS.NAME 50%

 SELECT COUNT(*)*(100/(SELECT COUNT(*) FROM ORDERS)) AS p
 ,ORDERS.PRODUCT_NAME FROM PRODUCTS JOIN ORDERS 
 ON ORDERS.PRODUCT_NAME = PRODUCTS.PRODUCT_NAME
 GROUP BY ORDERS.PRODUCT_NAME

.....................................................................
SELECT TOP(5)NAME , MAX(PRICE)
FROM CUSTOMERS
JOIN ORDERS
ON CUSTOMERS.CUSTOMER_ID = ORDERS.CUSTOMER_ID
JOIN PRODUCTS
ON PRODUCTS.PRODUCT_NAME = ORDERS.PRODUCT_NAME
GROUP BY PRICE,NAME                           

......................................................................
SELECT SUM(PRICE) OVER (ORDER BY  [PRODUCT_ID]) AS [Running Total]
FROM PRODUCTS

..................................................................... 8
SELECT TOP(3)ORDERS.ORDER_DATE ,CUSTOMERS.NAME,PRODUCTS.PRODUCT_NAME
FROM ORDERS
JOIN 
CUSTOMERS
ON CUSTOMERS.CUSTOMER_ID = ORDERS.CUSTOMER_ID
JOIN PRODUCTS
ON PRODUCTS.PRODUCT_NAME = ORDERS.PRODUCT_NAME
ORDER BY ORDER_DATE DESC                         

......................................................................
SELECT SUM(PRODUCTS.PRICE) , CUSTOMERS.NAME ,ORDERS.ORDER_DATE
FROM ORDERS
JOIN 
CUSTOMERS
ON CUSTOMERS.CUSTOMER_ID = ORDERS.CUSTOMER_ID
JOIN PRODUCTS
ON PRODUCTS.PRODUCT_NAME = ORDERS.PRODUCT_NAME
WHERE ORDERS.ORDER_DATE BETWEEN '2023-7-01' AND '2023-7-10'
GROUP BY CUSTOMERS.NAME,ORDERS.ORDER_DATE

.....................................................................
SELECT AVG(PRODUCTS.PRICE) , CUSTOMERS.NAME ,ORDERS.PRODUCT_NAME
FROM ORDERS
JOIN 
CUSTOMERS
ON CUSTOMERS.CUSTOMER_ID = ORDERS.CUSTOMER_ID
JOIN PRODUCTS
ON PRODUCTS.PRODUCT_NAME = ORDERS.PRODUCT_NAME
GROUP BY CUSTOMERS.NAME ,ORDERS.PRODUCT_NAME
....................................................................


...................................................................
SELECT  CUSTOMERS.NAME,PRODUCTS.PRODUCT_NAME,ORDERS.ORDER_DATE
FROM CUSTOMERS
JOIN
ORDERS
ON CUSTOMERS.CUSTOMER_ID = ORDERS.CUSTOMER_ID
JOIN
PRODUCTS
ON PRODUCTS.PRODUCT_NAME = ORDERS.PRODUCT_NAME


....................................................................
SELECT CUSTOMERS.NAME,PRODUCTS.PRODUCT_NAME,ORDERS.QUANTITY
FROM ORDERS
JOIN 
CUSTOMERS
ON CUSTOMERS.CUSTOMER_ID = ORDERS.CUSTOMER_ID
JOIN PRODUCTS
ON PRODUCTS.PRODUCT_NAME = ORDERS.PRODUCT_NAME
WHERE ORDERS.QUANTITY =2     